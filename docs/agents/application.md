# Application Layer Guide

대상: `src/application/**`

## 역할

유스케이스를 통해 도메인 규칙을 조합하고 실행 순서를 제어한다.
외부 시스템 접근은 포트(인터페이스)로 추상화해야 한다.
Hexagonal 기준으로 `application`은 inside의 진입점이며 포트 소유 계층이다.

## 포함 가능한 것

- 유스케이스(예: `ReviewPrUseCase`)
- 포트 인터페이스(`ports.rs`)
- 유스케이스 레벨 예외/검증

## 포함하면 안 되는 것

- 구체 인프라 타입 직접 생성/참조
- HTTP 요청 코드
- CLI 파싱 코드

## 설계 규칙

1. 유스케이스는 입력/출력 경계를 명확히 정의한다.
2. 외부 의존은 생성자/필드 주입으로 받는다.
3. 유스케이스는 도메인 정책을 호출해 흐름만 조정한다.
4. 트랜잭션성 흐름(예: claim -> 실행 -> final update)은 유스케이스에 둔다.

## 포트 설계 원칙

- 최소 인터페이스(필요한 동작만 노출)
- 기술 중립 시그니처 유지
- 반환 타입은 도메인 타입 우선 사용
- 인바운드/아웃바운드 포트 모두 `application`에서 선언
- 포트 이름은 유스케이스 목적 중심(`VcsGateway`, `ProviderAgent` 등)

## 리뷰 체크포인트

- 유스케이스에서 `infrastructure::*`를 직접 import 했는가?
- 도메인 규칙이 유스케이스 내부에 중복 구현되어 있지 않은가?
- 신규 외부 연동이 포트 없이 유스케이스에 직접 추가되지는 않았는가?
